<!-- pages/post-detail/post-detail.wxml -->
<app-layout current-tab="" current-filter="discover">
  <!-- Login Modal -->
  <login-modal wx:if="{{ showLoginModal }}" class="login-modal" />
  
  <!-- Post Viewer Container -->
  <view class="post-viewer-container">
    <!-- Media Player Component -->
    <media-player
      wx:if="{{ currentPost }}"
      selectedPost="{{ currentPost }}"
      selectedPostUser="{{ currentPostUser }}"
      followedUsers="{{ followedUsers }}"
      authUser="{{ userInfo }}"
      index="{{ currentIndex }}"
      totalCount="{{ totalPosts }}"
      bind:postNavigation="handlePostNavigation"
      bind:likeUpdated="handleLikeUpdated"
      bind:favoriteUpdated="handleFavoriteUpdated"
      bind:shareUpdated="handleShareUpdated"
      bind:followUpdated="handleFollowUpdated"
      bind:showLogin="showLoginModal"
      bind:navigateToProfile="navigateToUserProfile"
      bind:previousPost="handlePreviousPost"
      bind:nextPost="handleNextPost"
    >
    </media-player>

    <!-- Loading State -->
    <view wx:if="{{ isLoading }}" class="loading-container">
      <view class="loading-spinner"></view>
      <text class="loading-text">{{messages.loading}}</text>
    </view>
    
    <!-- Error State -->
    <view wx:elif="{{ loadError }}" class="error-container">
      <view class="error-icon">âš ï¸</view>
      <text class="error-text">{{errorMessage}}</text>
      <button class="retry-btn" bindtap="retryLoad">é‡è¯•</button>
    </view>
    
    <!-- Empty State -->
    <view wx:elif="{{ !currentPost }}" class="empty-container">
      <view class="empty-icon">ğŸ“­</view>
      <text class="empty-text">å†…å®¹ä¸å­˜åœ¨</text>      <button class="back-btn" bindtap="goBack">è¿”å›</button>
    </view>
  </view>
</app-layout>
