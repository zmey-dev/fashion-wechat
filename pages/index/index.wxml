<view class="page-container">
  <filter-bar currentFilter="discover"></filter-bar>

  <!-- Main Content Area -->
  <view class="content-area" id="contentArea">
    <!-- Posts Grid -->
    <view class="posts-grid">
      <view 
        wx:for="{{posts}}" 
        wx:key="id"
        class="post-card"
        data-post-id="{{item.id}}"
        data-index="{{index}}"
        bindtap="onPostTap"
      >
        <!-- Media Container -->
        <view class="media-container">
          <image 
            class="post-image"
            src="{{item.type === 'video' ? item.media[0].preview_url : item.media[0].url}}"
            lazy-load="{{true}}"
            mode="aspectFill"
          />
        </view>
        
        <!-- User Section -->
        <view class="user-section">
          <view class="user-info">
            <view class="user-row" catchtap="onUserTap" data-user-id="{{item.user.id}}">
              <avatar avatar="{{item.user.avatar}}" name="{{item.user.username}}" size="45"></avatar>
              <text class="user-name">{{item.user.username}}</text>
            </view>
          </view>
          <view class="like-display">
            <image class="heart-icon" src="/images/icons/heart.svg" mode="aspectFit"></image>
            <text class="like-count">{{item.likes}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- Loading State -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">{{messages.loading}}</text>
    </view>
    
    <!-- Empty State -->
    <view class="empty-state" wx:if="{{!loading && posts.length === 0}}">
      <text class="empty-icon">🔍</text>
      <text class="empty-title">还没有内容</text>
      <text class="empty-desc">稍后再来查看，或者尝试其他分类</text>
    </view>
    
    <!-- End Message -->
    <view class="end-message" wx:if="{{!hasMore && posts.length > 0}}">
      <text class="end-text">已经到底了</text>
    </view>
  </view>

  <!-- Scroll To Top Button -->
  <view 
    wx:if="{{showScrollTop}}" 
    class="scroll-top-button" 
    bindtap="onScrollToTop"
  >
    <text class="scroll-up-icon">⬆️</text>
  </view>
  
  <!-- Tab Bar Component -->
  <douyin-tabbar current="index"></douyin-tabbar>
  
  <!-- Login Modal -->
  <login-modal wx:if="{{showLoginModal}}" bind:close="onLoginClose" bind:success="onLoginSuccess" />
</view>