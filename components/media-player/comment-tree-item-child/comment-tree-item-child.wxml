<view class="comment-tree-item" style="margin-left: {{depth * 40}}rpx;">
  <!-- Main Comment -->
  <comment-item 
    wx:if="{{comment}}"
    item="{{comment}}"
    index="{{index}}"
    logged-user="{{loggedUser}}"
    selected-post="{{selectedPost}}"
    bind:like="onLikeHandle"
    bind:edit="onEditHandle"
    bind:reply="onReplyHandle"
    bind:delete="onDeleteHandle"
    bind:imagepreview="onImagePreviewHandle"
    bind:imageupload="onImageUploadHandle"
  />

  <!-- Reply Toggle Button -->
  <view wx:if="{{hasReplies}}" class="reply-toggle-container">
    <button 
      class="reply-toggle-btn" 
      bindtap="onToggleReplies"
    >
      <image 
        class="toggle-icon" 
        src="{{isExpanded ? '/images/icons/chevron-up.svg' : '/images/icons/chevron-down.svg'}}" 
      />
      <span class="toggle-text">
        {{isExpanded ? 'Hide replies' : 'View replies'}} ({{replies.length}})
      </span>
    </button>
    <view class="reply-toggle-line"></view>
  </view>

  <!-- Nested Replies -->
  <view 
    wx:if="{{hasReplies && isExpanded}}" 
    class="replies-container {{isExpanded ? 'expanded' : 'collapsed'}}"
  >
    <comment-tree-item 
      wx:for="{{replies}}" 
      wx:key="id"
      comment="{{item}}"
      all-comments="{{allComments}}"
      logged-user="{{loggedUser}}"
      selected-post="{{selectedPost}}"
      depth="{{depth + 1}}"
      bind:like="onLikeHandle"
      bind:edit="onEditHandle"
      bind:reply="onReplyHandle"
      bind:delete="onDeleteHandle"
      bind:imagepreview="onImagePreviewHandle"
      bind:imageupload="onImageUploadHandle"
    />
  </view>
</view>