<view class="login-modal" bindtap="closeModal">
  <view class="modal-content" catch:tap="preventClose">
    <!-- Header -->
    <view class="modal-header">
      <span class="modal-title">登录</span>
      <view class="close-btn" bindtap="closeModal">
        <span class="iconfont icon-close">×</span>
      </view>
    </view>

    <!-- Login Type Tabs -->
    <view class="login-tabs">
      <view 
        class="tab-item {{loginType === 'email' ? 'active' : ''}}"
        data-type="email"
        bindtap="switchLoginType"
      >
        <span>{{messages.loginTypes.email}}</span>
      </view>
      <view 
        class="tab-item {{loginType === 'phone' ? 'active' : ''}}"
        data-type="phone"
        bindtap="switchLoginType"
      >
        <span>{{messages.loginTypes.phone}}</span>
      </view>
    </view>

    <!-- Login Forms -->
    <view class="login-forms">
      <!-- WeChat Login -->
      <view class="form-container {{loginType === 'wechat' ? 'active' : ''}}">
        <view class="wechat-login">
          <view class="wechat-icon">
            <span class="icon">🔴</span>
          </view>
          <span class="wechat-span">微信一键登录</span>
          <span class="wechat-desc">安全便捷</span>
        </view>
      </view>

      <!-- Email Login -->
      <view class="form-container {{loginType === 'email' ? 'active' : ''}}">
        <view class="input-group">
          <input
            class="form-input {{emailError ? 'error' : ''}}"
            type="span"
            placeholder="{{messages.formLabels.email}}"
            value="{{email}}"
            bindinput="onEmailInput"
          />
          <span class="error-span" wx:if="{{emailError}}">{{emailError}}</span>
        </view>
        
        <view class="input-group">
          <view class="password-wrapper">
            <input
              class="form-input {{passwordError ? 'error' : ''}}"
              type="{{showPassword ? 'span' : 'password'}}"
              placeholder="{{messages.formLabels.password}}"
              value="{{password}}"
              bindinput="onPasswordInput"
            />
            <view class="password-toggle" bindtap="togglePassword">
              <span class="toggle-icon">{{showPassword ? '👁️' : '👁️‍🗨️'}}</span>
            </view>
          </view>
          <span class="error-span" wx:if="{{passwordError}}">{{passwordError}}</span>
        </view>
      </view>

      <!-- Phone Login -->
      <view class="form-container {{loginType === 'phone' ? 'active' : ''}}">
        <view class="input-group">
          <view class="phone-wrapper">
            <view class="country-code">+86</view>
            <input
              class="form-input {{phoneError ? 'error' : ''}}"
              type="number"
              placeholder="{{messages.formLabels.phone}}"
              value="{{phone}}"
              bindinput="onPhoneInput"
            />
          </view>
          <span class="error-span" wx:if="{{phoneError}}">{{phoneError}}</span>
        </view>
        
        <view class="input-group">
          <view class="code-wrapper">
            <input
              class="form-input code-input {{codeError ? 'error' : ''}}"
              type="number"
              placeholder="{{messages.formLabels.verificationCode}}"
              value="{{verificationCode}}"
              bindinput="onCodeInput"
              maxlength="6"
            />
            <button
              class="code-btn {{countdown > 0 ? 'disabled' : ''}}"
              bindtap="sendVerificationCode"
              disabled="{{countdown > 0}}"
            >
              {{countdown > 0 ? countdown + ' ' + messages.buttons.seconds : messages.buttons.sendCode}}
            </button>
          </view>
          <span class="error-span" wx:if="{{codeError}}">{{codeError}}</span>
        </view>
      </view>
    </view>

    <!-- Login Button -->
    <view class="login-button-wrapper">
      <button
        class="login-btn {{loading ? 'loading' : ''}}"
        bindtap="handleLogin"
        disabled="{{loading}}"
      >
        <span wx:if="{{!loading}}">
          {{loginType === 'wechat' ? '微信登录' : messages.buttons.login}}
        </span>
        <span wx:if="{{loading}}">登录中...</span>
      </button>
    </view>

    <!-- Footer -->
    <view class="modal-footer">
      <span class="terms-span">
        登录即表示您同意我们的
        <span class="link">服务条款</span> 和
        <span class="link">隐私政策</span>
      </span>
    </view>
  </view>
</view>
