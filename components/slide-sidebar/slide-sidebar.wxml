<!-- Header Bar -->
<view class="header-bar">
  <view class="header-left">
    <view class="hamburger-menu" bindtap="showSidebar">
      <view class="hamburger-line"></view>
      <view class="hamburger-line"></view>
      <view class="hamburger-line"></view>
    </view>
  </view>
  
  <view class="header-center">
    <view wx:if="{{!isSearchMode}}" class="title-container">
      <text class="page-title">{{pageTitle}}</text>
      <view class="search-btn" bindtap="toggleSearch">
        <view class="search-icon">
          <view class="search-circle"></view>
          <view class="search-handle"></view>
        </view>
      </view>
    </view>
    
    <view wx:else class="search-container">
      <view class="search-input-wrapper">
        <input class="search-input" 
               placeholder="搜索..." 
               value="{{searchValue}}"
               bindinput="onSearchInput"
               bindconfirm="onSearchConfirm"
               focus="{{isSearchMode}}" />
        <view class="search-clear" wx:if="{{searchValue}}" bindtap="cancelSearch">
          <view class="clear-icon"></view>
        </view>
      </view>
      <view class="search-cancel" bindtap="cancelSearch">
        <text>取消</text>
      </view>
    </view>
  </view>
</view>

<!-- Sidebar Container -->
<view class="sidebar-container" wx:if="{{isVisible}}">
  <!-- Overlay (Background) -->
  <view class="sidebar-overlay show" bindtap="hideSidebar" catchtouchmove="preventMove"></view>
  
  <!-- Sidebar -->
  <view class="sidebar {{isVisible ? 'show' : ''}}">
    <!-- Header -->
    <view class="sidebar-header">
      <view class="user-avatar">
        <image wx:if="{{userInfo.avatar}}" src="{{userInfo.avatar}}" class="avatar-img" />
        <view wx:else class="avatar-placeholder">
          <view class="svg-icon">
            <view class="svg-content">
              <view class="svg-circle"></view>
              <view class="svg-body"></view>
            </view>
          </view>
        </view>
      </view>
      <view class="user-info">
        <text class="username">{{userInfo.nickname || '用户'}}</text>
        <text class="user-role">学生</text>
      </view>
      <view class="close-btn" bindtap="hideSidebar">
        <view class="close-svg">
          <view class="close-line-1"></view>
          <view class="close-line-2"></view>
        </view>
      </view>
    </view>

    <!-- Navigation Menu -->
    <view class="nav-menu">
      <!-- Discover -->
      <view class="nav-item {{currentPath === 'discover' ? 'active' : ''}}" 
            bindtap="onNavItemTap" 
            data-destination="navigateToDiscover">
        <view class="nav-icon">
          <view class="thumbs-up-svg">
            <view class="thumb-main"></view>
            <view class="thumb-finger"></view>
          </view>
        </view>
        <text class="nav-label">精选</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Recommend -->
      <view class="nav-item {{currentPath === 'recommend' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToRecommend">
        <view class="nav-icon">
          <view class="sparkles-svg">
            <view class="spark spark-1"></view>
            <view class="spark spark-2"></view>
            <view class="spark spark-3"></view>
            <view class="spark spark-4"></view>
          </view>
        </view>
        <text class="nav-label">推荐</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Follow -->
      <view class="nav-item {{currentPath === 'follow' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToFollow">
        <view class="nav-icon">
          <view class="user-check-svg">
            <view class="user-circle"></view>
            <view class="user-body"></view>
            <view class="check-mark"></view>
          </view>
        </view>
        <text class="nav-label">关注</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Chat -->
      <view class="nav-item {{currentPath === 'chat' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToChat">
        <view class="nav-icon">
          <view class="message-svg">
            <view class="message-bubble"></view>
            <view class="message-tail"></view>
          </view>
        </view>
        <text class="nav-label">对话</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Friend -->
      <view class="nav-item {{currentPath === 'friend' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToFriend">
        <view class="nav-icon">
          <view class="users-svg">
            <view class="user-1">
              <view class="user-circle"></view>
              <view class="user-body"></view>
            </view>
            <view class="user-2">
              <view class="user-circle"></view>
              <view class="user-body"></view>
            </view>
          </view>
        </view>
        <text class="nav-label">朋友</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Me -->
      <view class="nav-item {{currentPath === 'me' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToMe">
        <view class="nav-icon">
          <view class="user-svg">
            <view class="user-circle"></view>
            <view class="user-body"></view>
          </view>
        </view>
        <text class="nav-label">我的</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Event -->
      <view class="nav-item {{currentPath === 'event' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToEvent">
        <view class="nav-icon">
          <view class="flag-svg">
            <view class="flag-pole"></view>
            <view class="flag-cloth"></view>
          </view>
        </view>
        <text class="nav-label">比赛</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
      
      <!-- Contact -->
      <view class="nav-item {{currentPath === 'contact' ? 'active' : ''}}" 
            bindtap="onNavItemTap"
            data-destination="navigateToContact">
        <view class="nav-icon">
          <view class="handshake-svg">
            <view class="hand-1"></view>
            <view class="hand-2"></view>
            <view class="heart"></view>
          </view>
        </view>
        <text class="nav-label">联系我们</text>
        <view class="arrow-svg">
          <view class="arrow-line"></view>
        </view>
      </view>
    </view>

    <!-- Footer -->
    <view class="sidebar-footer">
      <view class="app-info">
        <text class="app-name">学习助手</text>
        <text class="app-version">v1.0.0</text>
      </view>
    </view>
  </view>
</view>