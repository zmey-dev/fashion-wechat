<!-- search-bar.wxml -->
<view class="search-bar-container">
  <view class="search-bar {{isDiscoverPage ? 'active' : 'other-page'}}">
    <!-- University Dropdown -->
    <view class="university-dropdown">
      <view 
        class="dropdown-button" 
        bindtap="onUniversityTap"
      >
        <view class="dropdown-text">
          {{selectedUniversityName}}
        </view>
        <view class="dropdown-icon">
          <image src="/images/icons/chevron-down.svg" mode="aspectFit" />
        </view>
      </view>
      
      <!-- Dropdown Menu -->
      <view wx:if="{{showDropdown}}" class="dropdown-menu">
        <view class="dropdown-mask" bindtap="onDropdownMaskTap"></view>
        <view class="dropdown-content">
          <!-- University Search Input -->
          <view class="university-search-container">
            <view class="university-search-box">
              <view class="search-icon">ğŸ”</view>
              <input 
                class="university-search-input" 
                type="text" 
                placeholder="æœç´¢å¤§å­¦åç§°" 
                value="{{universitySearchText}}"
                bindinput="onUniversitySearchInput"
                confirm-type="search"
              />
              <view 
                wx:if="{{universitySearchText}}" 
                class="clear-icon" 
                bindtap="onClearUniversitySearch"
              >âœ•</view>
            </view>
          </view>
          
          <!-- All Universities Option -->
          <view 
            class="dropdown-item" 
            data-id="" 
            bindtap="onUniversitySelect"
          >
            <text>å…¨éƒ¨å­¦æ ¡</text>
          </view>
          
          <!-- Filtered University List (Top 5) -->
          <view 
            wx:for="{{filteredUniversities}}" 
            wx:key="id"
            class="dropdown-item" 
            data-id="{{item.id}}" 
            bindtap="onUniversitySelect"
          >
            <text>{{item.name}}</text>
          </view>
          
          <!-- Show message when search has results -->
          <view wx:if="{{universitySearchText && filteredUniversities.length === 0}}" class="no-results-message">
            <text>æœªæ‰¾åˆ°åŒ¹é…çš„å¤§å­¦</text>
          </view>
          
          <!-- Show message when showing limited results -->
          <view wx:if="{{universitySearchText && filteredUniversities.length === 5}}" class="limited-results-message">
            <text>æ˜¾ç¤ºå‰5ä¸ªç»“æœ</text>
          </view>
        </view>
      </view>
    </view>

    <!-- Search Input -->
    <input 
      class="search-input"
      type="text"
      placeholder="æœç´¢ä½ æ„Ÿå…´è¶£çš„å†…å®¹"
      value="{{filter}}"
      bindinput="onFilterInput"
      bindconfirm="onKeyboardConfirm"
      focus="{{autoFocus}}"
    />

    <!-- Clear Button -->
    <view 
      wx:if="{{filter}}" 
      class="clear-button" 
      bindtap="onClearTap"
    >
      <image src="/images/icons/X.svg" mode="aspectFit" />
    </view>

    <!-- Search Button -->
    <view 
      class="search-button" 
      bindtap="onSearchTap"
    >
      <image src="/images/icons/search.svg" mode="aspectFit" />
      <text>æœç´¢</text>
    </view>
  </view>
</view>